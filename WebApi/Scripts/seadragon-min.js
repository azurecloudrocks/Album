/*! 
 * Seadragon Ajax 0.8.9 (custom build from source) 
 * http://gallery.expression.microsoft.com/SeadragonAjax 
 * This code is distributed under the license agreement at: 
 * http://go.microsoft.com/fwlink/?LinkId=164943 
 */ 
(function(i,t,h,N){var m="100%",q=10,w="absolute",v="relative",p="hidden",L=" while executing ",g="function",D="mousewheel",l="px",C="inline-block",F="span",k="0px",B="none",u="div",H="fixed",J="undefined",z=",",o="number",d="",I="string",a=null,b=true,r=.5,c=false;if(!i.Seadragon)i.Seadragon={};var f=i.Seadragon,j=f.Config;(function(){if(j)return;j=f.Config={debugMode:c,animationTime:1.5,blendTime:r,alwaysBlend:c,autoHideControls:b,constrainDuringPan:b,immediateRender:c,logarithmicZoom:b,wrapHorizontal:c,wrapVertical:c,wrapOverlays:c,transformOverlays:c,minZoomDimension:a,minZoomImageRatio:.8,maxZoomPixelRatio:2,visibilityRatio:.8,springStiffness:5,imageLoaderLimit:2,clickTimeThreshold:200,clickDistThreshold:5,zoomPerClick:2,zoomPerScroll:h.pow(2,1/3),zoomPerSecond:2,proxyUrl:a,imagePath:"/Content/Images/"}})();var x=f.Strings;(function(){var a="Hmm, this doesn't appear to be a valid Deep Zoom Image.";if(x)return;x=f.Strings={Errors:{Failure:"Sorry, but Seadragon Ajax can't run on your browser!\nPlease try using IE 8 or Firefox 3.\n",Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:a,Xml:a,Empty:"You asked us to open nothing, so we did just that.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",Unknown:"Whoops, something inexplicably went wrong. Sorry!"},Messages:{Loading:"Loading..."},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in (you can also use your mouse's scroll wheel)",ZoomOut:"Zoom out (you can also use your mouse's scroll wheel)"}};x.getString=function(f){for(var c=f.split("."),a=x,b=0;b<c.length;b++)a=a[c[b]]||{};if(typeof a!=I)a=d;var e=arguments;return a.replace(/\{\d+\}/g,function(b){var a=parseInt(b.match(/\d+/))+1;return a<e.length?e[a]:d})};x.setString=function(e,d){for(var c=e.split("."),b=x,a=0;a<c.length-1;a++){if(!b[c[a]])b[c[a]]={};b=b[c[a]]}b[c[a]]=d}})();var s=function(){this.log=function(c,d){var a=i.console||{},b=j.debugMode;if(b&&a.log)a.log(c);else b&&d&&alert(c)};this.error=function(b,d){var c=i.console||{},a=j.debugMode;if(a&&c.error)c.error(b);else a&&alert(b);if(a)throw d||new Error(b)};this.fail=function(a){alert(x.getString("Errors.Failure"));throw new Error(a)}};s=f.Debug=new s;var U=f.Profiler=function(){var d=this,o=d,f=c,e=0,h=a,l=a,j=Infinity,g=0,i=0,n=Infinity,k=0,m=0;d.getAvgUpdateTime=function(){return g};d.getMinUpdateTime=function(){return j};d.getMaxUpdateTime=function(){return i};d.getAvgIdleTime=function(){return k};d.getMinIdleTime=function(){return n};d.getMaxIdleTime=function(){return m};d.isMidUpdate=function(){return f};d.getNumUpdates=function(){return e};d.beginUpdate=function(){f&&o.endUpdate();f=b;h=(new Date).getTime();if(e<1)return;var a=h-l;k=(k*(e-1)+a)/e;if(a<n)n=a;if(a>m)m=a};d.endUpdate=function(){if(!f)return;l=(new Date).getTime();f=c;var a=l-h;e++;g=(g*(e-1)+a)/e;if(a<j)j=a;if(a>i)i=a};d.clearProfile=function(){f=c;e=0;h=a;l=a;j=Infinity;g=0;i=0;n=Infinity;k=0;m=0}},n=f.Point;(function(){if(n)return;n=f.Point=function(a,b){this.x=typeof a==o?a:0;this.y=typeof b==o?b:0};var a=n.prototype;a.plus=function(a){return new n(this.x+a.x,this.y+a.y)};a.minus=function(a){return new n(this.x-a.x,this.y-a.y)};a.times=function(a){return new n(this.x*a,this.y*a)};a.divide=function(a){return new n(this.x/a,this.y/a)};a.negate=function(){return new n(-this.x,-this.y)};a.distanceTo=function(a){return h.sqrt(h.pow(this.x-a.x,2)+h.pow(this.y-a.y,2))};a.apply=function(a){return new n(a(this.x),a(this.y))};a.equals=function(a){return a instanceof n&&this.x===a.x&&this.y===a.y};a.toString=function(){return "("+this.x+z+this.y+")"}})();var y=f.Rect;(function(){if(y)return;y=f.Rect=function(d,e,c,b){var a=this;a.x=typeof d==o?d:0;a.y=typeof e==o?e:0;a.width=typeof c==o?c:0;a.height=typeof b==o?b:0};var a=y.prototype;a.getAspectRatio=function(){return this.width/this.height};a.getTopLeft=function(){return new n(this.x,this.y)};a.getBottomRight=function(){var a=this;return new n(a.x+a.width,a.y+a.height)};a.getCenter=function(){var a=this;return new n(a.x+a.width/2,a.y+a.height/2)};a.getSize=function(){return new n(this.width,this.height)};a.equals=function(a){var b=this;return a instanceof y&&b.x===a.x&&b.y===a.y&&b.width===a.width&&b.height===a.height};a.toString=function(){var a=this;return "["+a.x+z+a.y+z+a.width+"x"+a.height+"]"}})();var Q=f.Spring=function(i){var c=this,d=typeof i==o?i:0,e=d,b=d,a=(new Date).getTime(),g=a,f=a;function k(b){var a=j.springStiffness;return (1-h.exp(-b*a))/(1-h.exp(-a))}c.getCurrent=function(){return d};c.getTarget=function(){return b};c.resetTo=function(c){b=c;f=a;e=b;g=f};c.springTo=function(c){e=d;g=a;b=c;f=g+1e3*j.animationTime};c.shiftBy=function(a){e+=a;b+=a};c.update=function(){a=(new Date).getTime();d=a>=f?b:e+(b-e)*k((a-g)/(f-g))}},A=f.Browser={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},e=function(){var q="DOMMouseScroll",f=this,m=f,x=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"],z={bmp:c,jpeg:b,jpg:b,png:b,tif:c,wdp:c},r=A.UNKNOWN,p=0,v=c,y={};(function(){var d=navigator.appName,o=navigator.appVersion,a=navigator.userAgent;if(d=="Microsoft Internet Explorer"&&!!i.attachEvent&&!!i.ActiveXObject){var h=a.indexOf("MSIE");r=A.IE;p=parseFloat(a.substring(h+5,a.indexOf(";",h)));var j=t.documentMode;if(typeof j!==J)p=j}else if(d=="Netscape"&&!!i.addEventListener){var g=a.indexOf("Firefox"),b=a.indexOf("Safari"),l=a.indexOf("Chrome");if(g>=0){r=A.FIREFOX;p=parseFloat(a.substring(g+8))}else if(b>=0){var n=a.substring(0,b).lastIndexOf("/");r=l>=0?A.CHROME:A.SAFARI;p=parseFloat(a.substring(n+1,b))}}else if(d=="Opera"&&!!i.opera&&!!i.attachEvent){r=A.OPERA;p=parseFloat(o)}for(var m=i.location.search.substring(1),k=m.split("&"),f=0;f<k.length;f++){var c=k[f],e=c.indexOf("=");if(e>0)y[c.substring(0,e)]=decodeURIComponent(c.substring(e+1))}v=r==A.IE&&p<9||r==A.CHROME&&p<2})();function w(a,b){if(b&&a!=t.body)return t.body;else return a.offsetParent}f.getBrowser=function(){return r};f.getBrowserVersion=function(){return p};f.getElement=function(a){if(typeof a==I)a=t.getElementById(a);return a};f.getElementPosition=function(a){var a=m.getElement(a),b=new n,c=m.getElementStyle(a).position==H,d=w(a,c);while(d){b.x+=a.offsetLeft;b.y+=a.offsetTop;if(c)b=b.plus(m.getPageScroll());a=d;c=m.getElementStyle(a).position==H;d=w(a,c)}return b};f.getElementSize=function(a){var a=m.getElement(a);return new n(a.clientWidth,a.clientHeight)};f.getElementStyle=function(a){var a=m.getElement(a);if(a.currentStyle)return a.currentStyle;else if(i.getComputedStyle)return i.getComputedStyle(a,d);else s.fail("Unknown element style, no known technique.")};f.getEvent=function(a){return a?a:i.event};f.getMousePosition=function(a){var a=m.getEvent(a),b=new n;if(a.type==q&&r==A.FIREFOX&&p<3){b.x=a.screenX;b.y=a.screenY}else if(typeof a.pageX==o){b.x=a.pageX;b.y=a.pageY}else if(typeof a.clientX==o){b.x=a.clientX+t.body.scrollLeft+t.documentElement.scrollLeft;b.y=a.clientY+t.body.scrollTop+t.documentElement.scrollTop}else s.fail("Unknown event mouse position, no known technique.");return b};f.getMouseScroll=function(b){var b=m.getEvent(b),a=0;if(typeof b.wheelDelta==o)a=b.wheelDelta;else if(typeof b.detail==o)a=b.detail*-1;else s.fail("Unknown event mouse scroll, no known technique.");return a?a/h.abs(a):0};f.getPageScroll=function(){var a=new n,b=t.documentElement||{},c=t.body||{};if(typeof i.pageXOffset==o){a.x=i.pageXOffset;a.y=i.pageYOffset}else if(c.scrollLeft||c.scrollTop){a.x=c.scrollLeft;a.y=c.scrollTop}else if(b.scrollLeft||b.scrollTop){a.x=b.scrollLeft;a.y=b.scrollTop}return a};f.getWindowSize=function(){var a=new n,b=t.documentElement||{},c=t.body||{};if(typeof i.innerWidth==o){a.x=i.innerWidth;a.y=i.innerHeight}else if(b.clientWidth||b.clientHeight){a.x=b.clientWidth;a.y=b.clientHeight}else if(c.clientWidth||c.clientHeight){a.x=c.clientWidth;a.y=c.clientHeight}else s.fail("Unknown window size, no known technique.");return a};f.imageFormatSupported=function(a){var a=a?a:d;return !!z[a.toLowerCase()]};f.makeCenteredNode=function(h){var b="border:none; margin:0px; padding:0px;",h=e.getElement(h),c=m.makeNeutralElement(u),a=[];a.push('<div style="display:table; height:100%; width:100%;');a.push(b);a.push('#position:relative; overflow:hidden; text-align:left;">');a.push('<div style="#position:absolute; #top:50%; width:100%; ');a.push(b);a.push('display:table-cell; vertical-align:middle;">');a.push('<div style="#position:relative; #top:-50%; width:100%; ');a.push(b);a.push('text-align:center;"></div></div></div>');c.innerHTML=a.join(d);c=c.firstChild;var g=c,f=c.getElementsByTagName(u);while(f.length>0){g=f[0];f=g.getElementsByTagName(u)}g.appendChild(h);return c};f.makeNeutralElement=function(c){var b=t.createElement(c),a=b.style;a.background="transparent none";a.border=B;a.margin=k;a.padding=k;a.position="static";return b};f.makeTransparentImage=function(d){var c=m.makeNeutralElement("img"),b=a;if(r==A.IE&&p<7){b=m.makeNeutralElement(F);b.style.display=C;c.onload=function(){b.style.width=b.style.width||c.width+l;b.style.height=b.style.height||c.height+l;c.onload=a;c=a};c.src=d;b.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d+"', sizingMethod='scale')"}else{b=c;b.src=d}return b};f.setElementOpacity=function(b,a,f){var b=m.getElement(b);if(f&&v)a=h.round(a);if(a<1)b.style.opacity=a;else b.style.opacity=d;var c=b.style.filter||d;b.style.filter=c.replace(/[\s]*alpha\(.*?\)[\s]*/g,d);if(a>=1)return;var e=h.round(100*a),g=" alpha(opacity="+e+") ";b.style.filter+=g};f.addEvent=function(a,c,d,b){var a=m.getElement(a);if(a.addEventListener){c==D&&a.addEventListener(q,d,b);a.addEventListener(c,d,b)}else if(a.attachEvent){a.attachEvent("on"+c,d);b&&a.setCapture&&a.setCapture()}else s.fail("Unable to attach event handler, no known technique.")};f.removeEvent=function(a,c,d,b){var a=m.getElement(a);if(a.removeEventListener){c==D&&a.removeEventListener(q,d,b);a.removeEventListener(c,d,b)}else if(a.detachEvent){a.detachEvent("on"+c,d);b&&a.releaseCapture&&a.releaseCapture()}else s.fail("Unable to detach event handler, no known technique.")};f.cancelEvent=function(a){var a=m.getEvent(a);a.preventDefault&&a.preventDefault();a.cancel=b;a.returnValue=c};f.stopEvent=function(a){var a=m.getEvent(a);a.stopPropagation&&a.stopPropagation();a.cancelBubble=b};f.createCallback=function(d,c){for(var b=[],a=2;a<arguments.length;a++)b.push(arguments[a]);return function(){for(var e=b.concat([]),a=0;a<arguments.length;a++)e.push(arguments[a]);return c.apply(d,e)}};f.getUrlParameter=function(c){var b=y[c];return b?b:a};f.makeAjaxRequest=function(h,d){var c=typeof d==g,b=a;if(c)var l=d,d=function(){i.setTimeout(e.createCallback(a,l,b),1)};if(i.ActiveXObject)for(var k=0;k<x.length;k++)try{b=new ActiveXObject(x[k]);break}catch(f){continue}else if(i.XMLHttpRequest)b=new XMLHttpRequest;!b&&s.fail("Browser doesn't support XMLHttpRequest.");if(j.proxyUrl)h=j.proxyUrl+h;if(c)b.onreadystatechange=function(){if(b.readyState==4){b.onreadystatechange=new Function;d()}};try{b.open("GET",h,c);b.send(a)}catch(f){s.log(f.name+" while making AJAX request: "+f.message);b.onreadystatechange=a;b=a;c&&d()}return c?a:b};f.parseXml=function(e){var d=a;if(i.ActiveXObject)try{d=new ActiveXObject("Microsoft.XMLDOM");d.async=c;d.loadXML(e)}catch(b){s.log(b.name+" while parsing XML (ActiveX): "+b.message)}else if(i.DOMParser)try{var f=new DOMParser;d=f.parseFromString(e,"text/xml")}catch(b){s.log(b.name+" while parsing XML (DOMParser): "+b.message)}else s.fail("Browser doesn't support XML DOM.");return d}};e=f.Utils=new e;var M=f.MouseTracker;(function(){var d="mouseup",k="mousedown";if(M)return;var m=e.getBrowser()==A.IE&&e.getBrowserVersion()<9,p=c,u=c,r={},n=[];function q(a){return e.getMousePosition(a)}function l(b,d){var c=e.getMousePosition(b),a=e.getElementPosition(d);return c.minus(a)}function o(b,a){var d=t.body;while(a&&b!=a&&d!=a)try{a=a.parentNode}catch(e){return c}return b==a}function v(){p=b}function w(){p=c}(function(){if(m){e.addEvent(t,k,v,c);e.addEvent(t,d,w,c)}else{e.addEvent(i,k,v,b);e.addEvent(i,d,w,b)}})();M=f.MouseTracker=function(f){var w="mousemove",z="mouseout",y="mouseover",x=this,v=x,H=a,M=h.random(),f=e.getElement(f),F=c,A=c,C=c,E=c,G=a,O=a,N=a;x.target=f;x.enterHandler=a;x.exitHandler=a;x.pressHandler=a;x.releaseHandler=a;x.clickHandler=a;x.dragHandler=a;x.scrollHandler=a;function X(){if(!F){e.addEvent(f,y,K,c);e.addEvent(f,z,L,c);e.addEvent(f,k,U,c);e.addEvent(f,d,B,c);e.addEvent(f,D,R,c);e.addEvent(f,"click",T,c);F=b;r[M]=H}}function Z(){if(F){e.removeEvent(f,y,K,c);e.removeEvent(f,z,L,c);e.removeEvent(f,k,U,c);e.removeEvent(f,d,B,c);e.removeEvent(f,D,R,c);e.removeEvent(f,"click",T,c);I();F=c;delete r[M]}}function Y(){if(!A){if(m){e.removeEvent(f,d,B,c);e.addEvent(f,d,V,b);e.addEvent(f,w,Q,b)}else{e.addEvent(i,d,P,b);e.addEvent(i,w,J,b)}A=b}}function I(){if(A){if(m){e.removeEvent(f,w,Q,b);e.removeEvent(f,d,V,b);e.addEvent(f,d,B,c)}else{e.removeEvent(i,w,J,b);e.removeEvent(i,d,P,b)}A=c}}function S(c,d){var b=r;for(var a in b)b.hasOwnProperty(a)&&M!=a&&b[a][c](d)}function ab(){return E}function K(a){var a=e.getEvent(a);m&&A&&!o(a.srcElement,f)&&S("onMouseOver",a);var h=a.target?a.target:a.srcElement,d=a.relatedTarget?a.relatedTarget:a.fromElement;if(!o(f,h)||o(f,d))return;E=b;if(typeof v.enterHandler==g)try{v.enterHandler(v,l(a,f),C,p)}catch(c){s.error(c.name+" while executing enter handler: "+c.message,c)}}function L(a){var a=e.getEvent(a);m&&A&&!o(a.srcElement,f)&&S("onMouseOut",a);var d=a.target?a.target:a.srcElement,h=a.relatedTarget?a.relatedTarget:a.toElement;if(!o(f,d)||o(f,h))return;E=c;if(typeof v.exitHandler==g)try{v.exitHandler(v,l(a,f),C,p)}catch(b){s.error(b.name+" while executing exit handler: "+b.message,b)}}function U(a){var a=e.getEvent(a);if(a.button==2)return;C=b;G=q(a);N=G;O=(new Date).getTime();if(typeof v.pressHandler==g)try{v.pressHandler(v,l(a,f))}catch(c){s.error(c.name+" while executing press handler: "+c.message,c)}(v.pressHandler||v.dragHandler)&&e.cancelEvent(a);if(!m||!u){Y();u=b;n=[H]}else m&&n.push(H)}function B(a){var a=e.getEvent(a),h=C,d=E;if(a.button==2)return;C=c;if(typeof v.releaseHandler==g)try{v.releaseHandler(v,l(a,f),h,d)}catch(b){s.error(b.name+" while executing release handler: "+b.message,b)}h&&d&&W(a)}function V(a){var a=e.getEvent(a);if(a.button==2)return;for(var b=0;b<n.length;b++){var d=n[b];!d.hasMouse()&&d.onMouseUp(a)}I();u=c;a.srcElement.fireEvent("on"+a.type,t.createEventObject(a));e.stopEvent(a)}function P(a){!E&&B(a);I()}function T(a){v.clickHandler&&e.cancelEvent(a)}function W(a){var a=e.getEvent(a);if(a.button==2)return;var i=(new Date).getTime()-O,d=q(a),c=N.distanceTo(d),h=i<=j.clickTimeThreshold&&c<=j.clickDistThreshold;if(typeof v.clickHandler==g)try{v.clickHandler(v,l(a,f),h,a.shiftKey)}catch(b){s.error(b.name+" while executing click handler: "+b.message,b)}}function J(a){var a=e.getEvent(a),c=q(a),d=c.minus(G);G=c;if(typeof v.dragHandler==g){try{v.dragHandler(v,l(a,f),d,a.shiftKey)}catch(b){s.error(b.name+" while executing drag handler: "+b.message,b)}e.cancelEvent(a)}}function Q(b){for(var a=0;a<n.length;a++)n[a].onMouseMove(b);e.stopEvent(b)}function R(a){var a=e.getEvent(a),c=e.getMouseScroll(a);if(typeof v.scrollHandler==g){if(c)try{v.scrollHandler(v,l(a,f),c,a.shiftKey)}catch(b){s.error(b.name+" while executing scroll handler: "+b.message,b)}e.cancelEvent(a)}}(function(){H={hasMouse:ab,onMouseOver:K,onMouseOut:L,onMouseUp:B,onMouseMove:J}})();x.isTracking=function(){return F};x.setTracking=function(a){if(a)X();else Z()}}})();var W=f.EventManager=function(){var b=this,a={};b.addListener=function(b,c){if(typeof c!=g)return;if(!a[b])a[b]=[];a[b].push(c)};b.removeListener=function(e,d){var b=a[e];if(typeof d!=g)return;else if(!b)return;for(var c=0;c<b.length;c++)if(d==b[c]){b.splice(c,1);return}};b.clearListeners=function(b){if(a[b])delete a[b]};b.trigger=function(e){var d=a[e],f=[];if(!d)return;for(var b=1;b<arguments.length;b++)f.push(arguments[b]);for(var b=0;b<d.length;b++)try{d[b].apply(i,f)}catch(c){s.error(c.name+L+e+" handler: "+c.message,c)}}},S;(function(){var d=15000;function h(h,j){var e=a,f=a;function g(b){e.onload=a;e.onabort=a;e.onerror=a;f&&i.clearTimeout(f);i.setTimeout(function(){j(h,b?e:a)},1)}this.start=function(){e=new Image;var j=function(){g(b)},a=function(){g(c)},k=function(){s.log("Image timed out: "+h);g(c)};e.onload=j;e.onabort=a;e.onerror=a;f=i.setTimeout(k,d);e.src=h}}S=f.ImageLoader=function(){var d=0;function f(b,e,c){d--;if(typeof b==g)try{b(c)}catch(a){s.error(a.name+L+e+" callback: "+a.message,a)}}this.loadImage=function(l,g){if(d>=j.imageLoaderLimit)return c;var i=e.createCallback(a,f,g),k=new h(l,i);d++;k.start();return b}}})();var O,R;(function(){var j={REST:0,GROUP:1,HOVER:2,DOWN:3};O=f.Button=function(W,V,S,T,U,y,q,u,x,z){var l=e.makeNeutralElement(F),f=j.GROUP,m=new M(l),H=e.makeTransparentImage(V),r=e.makeTransparentImage(S),s=e.makeTransparentImage(T),t=e.makeTransparentImage(U),y=typeof y==g?y:a,q=typeof q==g?q:a,u=typeof u==g?u:a,x=typeof x==g?x:a,z=typeof z==g?z:a,G=0,P=2e3,D=a,B=c;this.elmt=l;function E(){i.setTimeout(R,20)}function R(){if(B){var c=(new Date).getTime(),d=c-D,a=1-d/P;a=h.min(1,a);a=h.max(0,a);e.setElementOpacity(r,a,b);a>0&&E()}}function N(){B=b;D=(new Date).getTime()+G;i.setTimeout(E,G)}function Q(){B=c;e.setElementOpacity(r,1,b)}function o(a){if(a>=j.GROUP&&f==j.REST){Q();f=j.GROUP}if(a>=j.HOVER&&f==j.GROUP){s.style.visibility=d;f=j.HOVER}if(a>=j.DOWN&&f==j.HOVER){t.style.visibility=d;f=j.DOWN}}function n(a){if(a<=j.HOVER&&f==j.DOWN){t.style.visibility=p;f=j.HOVER}if(a<=j.GROUP&&f==j.HOVER){s.style.visibility=p;f=j.GROUP}if(a<=j.REST&&f==j.GROUP){N();f=j.REST}}function K(d,c,a,b){if(a){o(j.DOWN);x&&x()}else!b&&o(j.HOVER)}function O(d,c,a){n(j.GROUP);a&&z&&z()}function L(){o(j.DOWN);y&&y()}function I(d,c,a,b){if(a&&b){n(j.HOVER);q&&q()}else if(a)n(j.GROUP);else o(j.HOVER)}function J(c,b,a){u&&a&&u()}this.notifyGroupEnter=function(){o(j.GROUP)};this.notifyGroupExit=function(){n(j.REST)};(function(){l.style.display=C;l.style.position=v;l.title=W;l.appendChild(H);l.appendChild(r);l.appendChild(s);l.appendChild(t);var g=H.style,f=r.style,a=s.style,c=t.style;f.position=a.position=c.position=w;f.top=a.top=c.top=k;f.left=a.left=c.left=k;a.visibility=c.visibility=p;if(e.getBrowser()==A.FIREFOX&&e.getBrowserVersion()<3)f.top=a.top=c.top=d;m.enterHandler=K;m.exitHandler=O;m.pressHandler=L;m.releaseHandler=I;m.clickHandler=J;m.setTracking(b);n(j.REST)})()};R=f.ButtonGroup=function(a){var d=e.makeNeutralElement(F),a=a.concat([]),c=new M(d);this.elmt=d;function f(){for(var b=0;b<a.length;b++)a[b].notifyGroupEnter()}function g(f,e,c){if(!c)for(var b=0;b<a.length;b++)a[b].notifyGroupExit()}function h(f,e,d,c){if(!c)for(var b=0;b<a.length;b++)a[b].notifyGroupExit()}this.emulateEnter=function(){f()};this.emulateExit=function(){g()};(function(){d.style.display=C;for(var e=0;e<a.length;e++)d.appendChild(a[e].elmt);c.enterHandler=f;c.exitHandler=g;c.releaseHandler=h;c.setTracking(b)})()}})();var T=f.TileSource=function(d,c,i,e,g,f){var b=this,a=b,j=c/d;b.width=d;b.height=c;b.aspectRatio=d/c;b.dimensions=new n(d,c);b.minLevel=g?g:0;b.maxLevel=f?f:h.ceil(h.log(h.max(d,c))/h.log(2));b.tileSize=i?i:0;b.tileOverlap=e?e:0;b.getLevelScale=function(b){return 1/(1<<a.maxLevel-b)};b.getNumTiles=function(e){var b=a.getLevelScale(e),f=h.ceil(b*d/a.tileSize),g=h.ceil(b*c/a.tileSize);return new n(f,g)};b.getPixelRatio=function(c){var b=a.dimensions.times(a.getLevelScale(c)),d=1/b.x,e=1/b.y;return new n(d,e)};b.getTileAtPoint=function(g,d){var b=a.dimensions.times(a.getLevelScale(g)),c=d.times(b.x),e,f;if(d.x>=0&&d.x<=1)e=h.floor(c.x/a.tileSize);else e=h.ceil(b.x/a.tileSize)*h.floor(c.x/b.x)+h.floor((b.x+c.x%b.x)%b.x/a.tileSize);if(d.y>=0&&d.y<=j)f=h.floor(c.y/a.tileSize);else f=h.ceil(b.y/a.tileSize)*h.floor(c.y/b.y)+h.floor((b.y+c.y%b.y)%b.y/a.tileSize);return new n(e,f)};b.getTileBounds=function(k,f,g){var c=a.dimensions.times(a.getLevelScale(k)),i=f===0?0:a.tileSize*f-a.tileOverlap,j=g===0?0:a.tileSize*g-a.tileOverlap,d=a.tileSize+(f===0?1:2)*a.tileOverlap,e=a.tileSize+(g===0?1:2)*a.tileOverlap;d=h.min(d,c.x-i);e=h.min(e,c.y-j);var b=1/c.x;return new y(i*b,j*b,d*b,e*b)};b.getTileUrl=function(){throw new Error("Method not implemented.")};b.tileExists=function(b,d,e){var c=a.getNumTiles(b);return b>=a.minLevel&&b<=a.maxLevel&&d>=0&&e>=0&&d<c.x&&e<c.y}},P=f.DisplayRect=function(e,f,d,c,b,a){y.apply(this,arguments);this.minLevel=b;this.maxLevel=a};P.prototype=new y;var K=f.DziTileSource=function(m,l,e,j,k,i,f){var a=this;T.apply(a,[m,l,e,j]);var n=a,g={};a.fileFormat=i;a.tileFormat=i;a.displayRects=f;(function(){if(!f)return;for(var c=f.length-1;c>=0;c--)for(var b=f[c],a=b.minLevel;a<=b.maxLevel;a++){if(!g[a])g[a]=[];g[a].push(b)}})();a.getTileUrl=function(a,b,c){return [k,a,"/",b,"_",c,".",i].join(d)};a.tileExists=function(d,p,q){var f=g[d];if(!f||!f.length)return b;for(var i=n.getLevelScale(d),o=f.length-1;o>=0;o--){var a=f[o];if(d<a.minLevel||d>a.maxLevel)continue;var j=a.x*i,k=a.y*i,l=j+a.width*i,m=k+a.height*i;j=h.floor(j/e);k=h.floor(k/e);l=h.ceil(l/e);m=h.ceil(m/e);if(j<=p&&p<l&&k<=q&&q<m)return b}return c}};K.prototype=new T;(function(){var c="Errors.Empty";function b(a){Error.apply(this,arguments);this.message=a}b.prototype=new Error;function h(a){if(!(a instanceof b)){s.error(a.name+" while creating DZI from XML: "+a.message);a=new b(x.getString("Errors.Unknown"))}return a}function d(d){var a=d.split("/"),b=a[a.length-1],c=b.lastIndexOf(".");if(c>-1)a[a.length-1]=b.slice(0,c);return a.join("/")+"_files/"}function j(c,i){if(!c)throw new b(x.getString("Errors.Security"));else if(c.status!==200&&c.status!==0){var g=c.status,h=g==404?"Not Found":c.statusText;throw new b(x.getString("Errors.Status",g,h))}var d=a;if(c.responseXML&&c.responseXML.documentElement)d=c.responseXML;else if(c.responseText)d=e.parseXml(c.responseText);return f(d,i)}function f(d,g){var a="Errors.Dzi";if(!d||!d.documentElement)throw new b(x.getString("Errors.Xml"));var e=d.documentElement,c=e.tagName;if(c=="Image")try{return l(e,g)}catch(f){var h=x.getString(a);throw f instanceof b?f:new b(h)}else if(c=="Collection")throw new b(x.getString("Errors.Dzc"));else if(c=="Error")return k(e);throw new b(x.getString(a))}function l(a,m){var f=a.getAttribute("Format");if(!e.imageFormatSupported(f))throw new b(x.getString("Errors.ImageFormat",f.toUpperCase()));for(var j=a.getElementsByTagName("Size")[0],h=a.getElementsByTagName("DisplayRect"),o=parseInt(j.getAttribute("Width"),q),n=parseInt(j.getAttribute("Height"),q),l=parseInt(a.getAttribute("TileSize")),k=parseInt(a.getAttribute("Overlap")),i=[],g=0;g<h.length;g++){var d=h[g],c=d.getElementsByTagName("Rect")[0];i.push(new P(parseInt(c.getAttribute("X"),q),parseInt(c.getAttribute("Y"),q),parseInt(c.getAttribute("Width"),q),parseInt(c.getAttribute("Height"),q),parseInt(d.getAttribute("MinLevel"),q),parseInt(d.getAttribute("MaxLevel"),q)))}return new K(o,n,l,k,m,f,i)}function k(c){var a=c.getElementsByTagName("Message")[0],d=a.firstChild.nodeValue;throw new b(d)}K.getTilesUrl=d;K.createFromJson=function(q,o){var r=typeof o==g,m,k,f=q;if(!f||!f.url&&!f.tilesUrl)k=new b(x.getString(c));else try{var l=f.displayRects;if(l&&l.length)for(var n=0,s=l.length;n<s;n++){var j=l[n];l[n]=new P(j.x||j[0],j.y||j[1],j.width||j[2],j.height||j[3],j.minLevel||j[4],j.maxLevel||j[5])}m=new K(f.width,f.height,f.tileSize,f.tileOverlap,f.tilesUrl||d(f.url),f.tileFormat,f.displayRects);m.xmlUrl=f.url}catch(p){k=h(p)}if(r)i.setTimeout(e.createCallback(a,o,m,k&&k.message),1);else if(k)throw k;else return m};K.createFromXml=function(l,m,n){var p=typeof n==g,k=a;if(!l){k=x.getString(c);if(p){i.setTimeout(function(){n(a,k)},1);return a}throw new b(k)}var q=d(l);function o(d,e){try{var c=d(e,q);c.xmlUrl=l;return c}catch(b){if(p){k=h(b).message;return a}else throw h(b)}}if(p){if(m)i.setTimeout(function(){var a=o(f,e.parseXml(m));n(a,k)},1);else e.makeAjaxRequest(l,function(b){var a=o(j,b);n(a,k)});return a}if(m)return o(f,e.parseXml(m));else return o(j,e.makeAjaxRequest(l))}})();var X=f.Viewport=function(e,o){var d=this,c=d,e=new n(e.x,e.y),u=o.x/o.y,p=o.y/o.x,i=new Q(0),k=new Q(0),m=new Q(j.logarithmicZoom?0:1),g=a,l=new y(0,0,1,p),s=l.getCenter(),A=h.LN2;function z(){c.goHome(b);c.update()}function v(a){return h.log(a)/A}function w(a){return h.pow(2,a)}function t(c,b,a){return h.min(h.max(c,b),a)}function x(b,a){var d=b.x,f=b.y,c=t(d,a.x,a.x+a.width),e=t(f,a.y,a.y+a.height);return d===c&&f===e?b:new n(c,e)}function q(i){var l=c.getZoom(i),h=1/l,k=h/c.getAspectRatio(),g=j.visibilityRatio,d=(g-r)*h,e=(g-r)*k,a=1-2*d,b=p-2*e;if(a<0){d+=r*a;a=0}if(b<0){e+=r*b;b=0}return new f.Rect(d,e,a,b)}d.getHomeBounds=function(){var b=c.getAspectRatio(),a=new y(l.x,l.y,l.width,l.height);if(u>=b){a.height=l.width/b;a.y=s.y-a.height/2}else{a.width=l.height*b;a.x=s.x-a.width/2}return a};d.getHomeCenter=function(){return s};d.getHomeZoom=function(){var a=u/c.getAspectRatio();return a>=1?1:a};d.getMinCenter=function(a){return q(a).getTopLeft()};d.getMaxCenter=function(a){return q(a).getBottomRight()};d.getMinZoom=function(){var a=c.getHomeZoom();if(j.minZoomDimension)var b=o.x<=o.y?j.minZoomDimension/e.x:j.minZoomDimension/(e.x*p);else var b=j.minZoomImageRatio*a;return h.min(b,a)};d.getMaxZoom=function(){var a=o.x*j.maxZoomPixelRatio/e.x;return h.max(a,c.getHomeZoom())};d.getAspectRatio=function(){return e.x/e.y};d.getContainerSize=function(){return new n(e.x,e.y)};d.getBounds=function(b){var d=c.getCenter(b),a=1/c.getZoom(b),e=a/c.getAspectRatio();return new y(d.x-a/2,d.y-e/2,a,e)};d.getCenter=function(r){var a=new n(i.getCurrent(),k.getCurrent()),f=new n(i.getTarget(),k.getTarget());if(r)return a;else if(!g)return f;var l=c.getZoom(),d=1/l,j=d/c.getAspectRatio(),h=new y(a.x-d/2,a.y-j/2,d,j),q=c.pixelFromPoint(g,b),p=g.minus(h.getTopLeft()).times(e.x/h.width),m=p.minus(q),o=m.divide(e.x*l);return f.plus(o)};d.getZoom=function(b){var a;if(b){a=m.getCurrent();return j.logarithmicZoom?w(a):a}else{a=m.getTarget();return j.logarithmicZoom?w(a):a}};d.applyConstraints=function(f){var h=c.getZoom(),d=t(h,c.getMinZoom(),c.getMaxZoom());h!=d&&c.zoomTo(d,g,f);var b=c.getCenter(),a=x(b,q());if(j.wrapHorizontal)a.x=b.x;if(j.wrapVertical)a.y=b.y;if(!b.equals(a)){var e=1/d,i=e/c.getAspectRatio();c.fitBounds(new y(a.x-r*e,a.y-r*i,e,i),f)}};d.ensureVisible=function(a){c.applyConstraints(a)};d.fitBounds=function(f,j){var h=c.getAspectRatio(),i=f.getCenter(),d=new y(f.x,f.y,f.width,f.height);if(d.getAspectRatio()>=h){d.height=f.width/h;d.y=i.y-d.height/2}else{d.width=f.height*h;d.x=i.x-d.width/2}c.panTo(c.getCenter(b),b);c.zoomTo(c.getZoom(b),a,b);var g=c.getBounds(),m=c.getZoom(),k=1/d.width;if(k==m||d.width==g.width){c.panTo(i,j);return}var l=g.getTopLeft().times(e.x/g.width).minus(d.getTopLeft().times(e.x/d.width)).divide(e.x/g.width-e.x/d.width);c.zoomTo(k,l,j)};d.goHome=function(b){var a=c.getCenter();if(j.wrapHorizontal){a.x=(1+a.x%1)%1;i.resetTo(a.x);i.update()}if(j.wrapVertical){a.y=(p+a.y%p)%p;k.resetTo(a.y);k.update()}c.fitBounds(l,b)};d.panBy=function(b,a){c.panTo(c.getCenter().plus(b),a)};d.panTo=function(a,q){if(q){i.resetTo(a.x);k.resetTo(a.y);return}if(!g){i.springTo(a.x);k.springTo(a.y);return}var l=c.getZoom(),d=1/l,j=d/c.getAspectRatio(),h=new y(i.getCurrent()-d/2,k.getCurrent()-j/2,d,j),p=c.pixelFromPoint(g,b),o=g.minus(h.getTopLeft()).times(e.x/h.width),m=o.minus(p),n=m.divide(e.x*l),f=a.minus(n);i.springTo(f.x);k.springTo(f.y)};d.zoomBy=function(d,b,a){c.zoomTo(c.getZoom()*d,b,a)};d.zoomTo=function(b,c,d){if(d)m.resetTo(j.logarithmicZoom?v(b):b);else m.springTo(j.logarithmicZoom?v(b):b);g=c instanceof n?c:a};d.resize=function(d,h){var f=c.getBounds(),a=f,g=d.x/e.x;e=new n(d.x,d.y);if(h){a.width=f.width*g;a.height=a.width/c.getAspectRatio()}c.fitBounds(a,b)};d.update=function(){var l=i.getCurrent(),n=k.getCurrent(),e=m.getCurrent();if(g)var j=c.pixelFromPoint(g,b);m.update();if(g&&m.getCurrent()!=e){var h=c.pixelFromPoint(g,b),f=h.minus(j),d=c.deltaPointsFromPixels(f,b);i.shiftBy(d.x);k.shiftBy(d.y)}else g=a;i.update();k.update();return i.getCurrent()!=l||k.getCurrent()!=n||m.getCurrent()!=e};d.deltaPixelsFromPoints=function(a,b){return a.times(e.x*c.getZoom(b))};d.deltaPointsFromPixels=function(a,b){return a.divide(e.x*c.getZoom(b))};d.pixelFromPoint=function(d,b){var a=c.getBounds(b);return d.minus(a.getTopLeft()).times(e.x/a.width)};d.pointFromPixel=function(d,b){var a=c.getBounds(b);return d.divide(e.x/a.width).plus(a.getTopLeft())};z()},V,E;(function(){var o="progid:DXImageTransform.Microsoft.Matrix(",k=" when it's not yet loaded.",i="Attempting to draw tile ",W=100,G=r,v=e.getBrowser(),P=e.getBrowserVersion(),bb=navigator.userAgent,R=!!t.createElement("canvas").getContext,T=t.documentElement||{},H=T.style||{},C=c,K=["msTransform","WebkitTransform","MozTransform"],g,B;while(g=K.shift())if(typeof H[g]!==J){C=b;B=/webkit/i.test(g);break}var X="-webkit-transform",L="WebkitTransition",Z=typeof H[L]!==J,O="progid:DXImageTransform.Microsoft.Matrix",Y=new RegExp(O+"\\(.*?\\)","g"),ab=function(){try{return v==A.IE&&!!t.documentElement.filters}catch(a){return c}}(),Q=v==A.SAFARI&&P<4||v==A.CHROME,q=R&&!Q,F=!q&&C,I=c,M=typeof t.documentMode!==J?"bicubic":"nearest-neighbor";function p(f,h,i,d,e,g){var b=this;b.level=f;b.x=h;b.y=i;b.bounds=d;b.exists=e;b.url=g;b.elmt=a;b.image=a;b.loaded=c;b.loading=c;b.style=a;b.position=a;b.size=a;b.blendStart=a;b.opacity=a;b.distance=a;b.visibility=a;b.beingDrawn=c;b.lastDrawnTime=0;b.lastTouchTime=0}p.prototype.toString=function(){return this.level+"/"+this.x+"_"+this.y};p.prototype.drawHTML=function(j){var a=this;if(!a.loaded){s.error(i+a.toString()+k);return}if(!a.elmt){a.elmt=e.makeNeutralElement("img");a.elmt.src=a.url;a.style=a.elmt.style;a.style.position=w;a.style.msInterpolationMode=M;if(F)a.style[g+"Origin"]="0px 0px"}var m=a.elmt,q=a.image,c=a.style,b=a.position,f=a.size;m.parentNode!=j&&j.appendChild(m);if(F)c[g]=["matrix(",(f.x/q.width).toFixed(8),",0,0,",(f.y/q.height).toFixed(8),z,b.x.toFixed(8),B?z:"px,",b.y.toFixed(8),B?")":"px)"].join(d);else if(I){var p=j.clientWidth,n=j.clientHeight;c.width=p+l;c.height=n+l;c.filter=[o,"M11=",(f.x/p).toFixed(8),",M22=",(f.y/n).toFixed(8),",Dx=",b.x.toFixed(8),",Dy=",b.y.toFixed(8),")"].join(d)}else{b=b.apply(h.floor);f=f.apply(h.ceil);c.left=b.x+l;c.top=b.y+l;c.width=f.x+l;c.height=f.y+l}e.setElementOpacity(m,a.opacity)};p.prototype.drawCanvas=function(c){var a=this;if(!a.loaded){s.error(i+a.toString()+k);return}var b=a.position,d=a.size;c.globalAlpha=a.opacity;c.drawImage(a.image,b.x,b.y,d.x,d.y)};p.prototype.unload=function(){var b=this;b.elmt&&b.elmt.parentNode&&b.elmt.parentNode.removeChild(b.elmt);b.elmt=a;b.image=a;b.loaded=c;b.loading=c};E=f.OverlayPlacement={CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8};function D(a){switch(a){case E.TOP_LEFT:return function(){};case E.TOP:return function(a,b){a.x-=b.x/2};case E.TOP_RIGHT:return function(a,b){a.x-=b.x};case E.RIGHT:return function(a,b){a.x-=b.x;a.y-=b.y/2};case E.BOTTOM_RIGHT:return function(a,b){a.x-=b.x;a.y-=b.y};case E.BOTTOM:return function(a,b){a.x-=b.x/2;a.y-=b.y};case E.BOTTOM_LEFT:return function(a,b){a.y-=b.y};case E.LEFT:return function(a,b){a.y-=b.y/2};case E.CENTER:default:return function(a,b){a.x-=b.x/2;a.y-=b.y/2}}}function x(c,a,d){var b=this;b.elmt=c;b.scales=a instanceof y;b.bounds=new y(a.x,a.y,a.width,a.height);b.adjust=D(a instanceof n?d:E.TOP_LEFT);b.position=new n(a.x,a.y);b.size=new n(a.width,a.height);b.style=c.style;b.naturalSize=new n(c.clientWidth,c.clientHeight)}x.prototype.destroy=function(){var b=this.elmt,a=this.style;b.parentNode&&b.parentNode.removeChild(b);a.top=d;a.left=d;a.position=d;if(this.scales){a.width=d;a.height=d}};x.prototype.drawHTML=function(k){var f=this,c=f.elmt,a=f.style,n=f.scales,i=f.naturalSize;if(c.parentNode!=k){k.appendChild(c);a.position=w;i.x=c.clientWidth;i.y=c.clientHeight}var e=f.position,b=f.size;if(!n){b.x=i.x=i.x||c.clientWidth;b.y=i.y=i.y||c.clientHeight}f.adjust(e,b);if(j.transformOverlays&&C){a[g+"Origin"]="0px 0px";a[g]=["translate(",e.x.toFixed(8),"px,",e.y.toFixed(8),"px)"].join(d);if(n){if(!c.clientWidth)a.width=m;if(!c.clientHeight)a.height=m;a[g]+=[" scale(",(b.x/c.clientWidth).toFixed(8),z,(b.y/c.clientHeight).toFixed(8),")"].join(d)}}else if(j.transformOverlays&&I){var q=k.clientWidth,p=k.clientHeight;a.width=q+l;a.height=p+l;a.filter=[o,"M11=",(b.x/q).toFixed(8),",M22=",(b.y/p).toFixed(8),",Dx=",e.x.toFixed(8),",Dy=",e.y.toFixed(8),")"].join(d)}else{e=e.apply(h.floor);b=b.apply(h.ceil);a.left=e.x+l;a.top=e.y+l;if(n){a.width=b.x+l;a.height=b.y+l}}};x.prototype.update=function(a,b){this.scales=a instanceof y;this.bounds=new y(a.x,a.y,a.width,a.height);this.adjust=D(a instanceof n?b:E.TOP_LEFT)};V=f.Drawer=function(f,C,ib){var g=this,B=e.getElement(ib),z=e.makeNeutralElement(q?"canvas":u),gb=q?z.getContext("2d"):a,T=new S,J=new U,eb=f.minLevel,db=f.maxLevel,fb=f.tileSize,X=f.tileOverlap,H=f.height/f.width,F={},D={},o={},t=[],k={},l=[],bb=[],K=0,L=0,I=c,i=b;g.elmt=B;g.profiler=J;(function(){z.style.width=m;z.style.height=m;z.style.position=w;B.style.textAlign="left";B.appendChild(z)})();function R(a){if(!F[a])F[a]=f.getNumTiles(a);return F[a]}function M(a){if(!D[a])D[a]=f.getPixelRatio(a);return D[a]}function hb(a,b,c,l,d,e){if(!o[a])o[a]={};if(!o[a][b])o[a][b]={};if(!o[a][b][c]){var g=(d+b%d)%d,h=(e+c%e)%e,i=f.getTileBounds(a,g,h),k=f.tileExists(a,g,h),m=f.getTileUrl(a,g,h);i.x+=1*(b-g)/d;i.y+=H*(c-h)/e;o[a][b][c]=new p(a,b,c,i,k,m)}var j=o[a][b][c];j.lastTouchTime=l;return j}function cb(b,c){b.loading=T.loadImage(b.url,e.createCallback(a,Z,b,c))}function Z(d,r,n){d.loading=c;if(I){s.error("Tile load callback in middle of drawing routine.");return}else if(!n){s.log("Tile "+d+" failed to load: "+d.url);d.exists=c;return}else if(r<L){s.log("Ignoring tile "+d+" loaded before reset: "+d.url);return}d.loaded=b;d.image=n;var k=t.length;if(t.length>=W){for(var q=h.ceil(h.log(fb)/h.log(2)),e=a,j=-1,g=t.length-1;g>=0;g--){var f=t[g];if(f.level<=q||f.beingDrawn)continue;else if(!e){e=f;j=g;continue}var m=f.lastTouchTime,l=e.lastTouchTime,p=f.level,o=e.level;if(m<l||m==l&&p>o){e=f;j=g}}if(e&&j>=0){e.unload();k=j}}t[k]=d;i=b}function Y(){o={};t=[]}function y(a,d,g){if(!k[a])return c;if(d===N||g===N){var f=k[a];for(var h in f)if(f.hasOwnProperty(h)){var e=f[h];for(var i in e)if(e.hasOwnProperty(i)&&!e[i])return c}return b}return k[a][d]===N||k[a][d][g]===N||k[a][d][g]===b}function ab(a,b,c){if(b===N||c===N)return y(a+1);else return y(a+1,2*b,2*c)&&y(a+1,2*b,2*c+1)&&y(a+1,2*b+1,2*c)&&y(a+1,2*b+1,2*c+1)}function V(a,b,d,c){if(!k[a]){s.error("Setting coverage for a tile before its level's coverage has been reset: "+a);return}if(!k[a][b])k[a][b]={};k[a][b][d]=c}function O(a){k[a]={}}function P(b,a){if(!b)return a;if(a.visibility>b.visibility)return a;else if(a.visibility==b.visibility)if(a.distance<b.distance)return a;return b}function E(b){for(var a=l.length-1;a>=0;a--)if(l[a].elmt==b)return a;return -1}function Q(){i=c;var Q=z,Fb=gb,gc=B,xb=q,D=bb;while(D.length>0){var e=D.pop();e.beingDrawn=c}var ub=C.getContainerSize(),sb=ub.x,rb=ub.y;if(xb){Q.width=sb;Q.height=rb;Fb.clearRect(0,0,sb,rb)}else Q.innerHTML=d;var qb=C.getBounds(b),t=qb.getTopLeft(),s=qb.getBottomRight();if(!j.wrapHorizontal&&(s.x<0||t.x>1))return;else if(!j.wrapVertical&&(s.y<0||t.y>H))return;var Rb=R,F=M,cc=hb,Yb=ab,I=V,Ob=O,Kb=y,Sb=X,Nb=K,bc=v===A.CHROME,ec=h.abs,hc=h.ceil,jb=h.floor,T=h.log,lb=h.max,k=h.min,p=C.deltaPixelsFromPoints,E=C.pixelFromPoint,pb=f.getTileAtPoint,Tb=j.alwaysBlend,U=1e3*j.blendTime,Lb=j.immediateRender,Y=j.minZoomDimension,fc=j.minImageRatio,W=j.wrapHorizontal,Z=j.wrapVertical,vb=j.wrapOverlays;if(!W){t.x=lb(t.x,0);s.x=k(s.x,1)}if(!Z){t.y=lb(t.y,0);s.y=k(s.y,H)}var S=a,L=c,u=(new Date).getTime(),mb=C.getCenter(),Ib=E(mb),Xb=p(F(0),c).x,nb=Lb?1:Xb;Y=Y||64;var J=lb(eb,jb(T(Y)/T(2))),Wb=p(F(0),b).x,tb=k(db,jb(T(Wb/G)/T(2)));J=k(J,tb);for(var g=tb;g>=J;g--){var zb=c,ob=p(F(g),b).x;if(!L&&ob>=G||g==J){zb=b;L=b}else if(!L)continue;Ob(g);var Pb=k(1,(ob-r)/r),Jb=p(F(g),c).x,Mb=nb/ec(nb-Jb),Hb=pb(g,t),w=pb(g,s),Eb=Rb(g),Ab=Eb.x,Bb=Eb.y;if(!W)w.x=k(w.x,Ab-1);if(!Z)w.y=k(w.y,Bb-1);for(var m=Hb.x;m<=w.x;m++)for(var o=Hb.y;o<=w.y;o++){var e=cc(g,m,o,u,Ab,Bb),fb=zb;I(g,m,o,c);if(!e.exists)continue;if(L&&!fb)if(Yb(g,m,o))I(g,m,o,b);else fb=b;if(!fb)continue;var Db=e.bounds.getTopLeft(),wb=e.bounds.getSize(),Zb=E(Db,b),kb=p(wb,b);if(!Sb)kb=kb.plus(new n(1,1));var ac=E(Db,c),dc=p(wb,c),Vb=ac.plus(dc.divide(2)),Qb=Ib.distanceTo(Vb);e.position=Zb;e.size=kb;e.distance=Qb;e.visibility=Mb;if(e.loaded){if(!e.blendStart)e.blendStart=u;var yb=u-e.blendStart,ib=U===0?1:k(1,yb/U);if(Tb)ib*=Pb;e.opacity=ib;D.push(e);if(ib>=1){I(g,m,o,b);bc&&e.lastDrawnTime!==Nb&&I(g,m,o,c)}else if(yb<U)i=b;e.lastDrawnTime=u}else if(!e.loading)S=P(S,e)}if(Kb(g))break}for(var x=D.length-1;x>=0;x--){var e=D[x];if(xb)e.drawCanvas(Fb);else e.drawHTML(Q);e.beingDrawn=b}for(var Ub=l.length,x=0;x<Ub;x++){var N=l[x],Gb=N.bounds,Cb=Gb.getTopLeft();if(vb&&W)Cb.x+=jb(mb.x);if(vb&&Z);N.position=E(Cb,b);N.size=p(Gb.getSize(),b);N.drawHTML(B)}if(S){cb(S,u);i=b}K=u}g.addOverlay=function(a,d,c){var a=e.getElement(a);if(E(a)>=0)return;l.push(new x(a,d,c));i=b};g.updateOverlay=function(a,f,d){var a=e.getElement(a),c=E(a);if(c>=0){l[c].update(f,d);i=b}};g.removeOverlay=function(c){var c=e.getElement(c),a=E(c);if(a>=0){l[a].destroy();l.splice(a,1);i=b}};g.clearOverlays=function(){while(l.length>0){l.pop().destroy();i=b}};g.needsUpdate=function(){return i};g.numTilesLoaded=function(){return t.length};g.reset=function(){Y();L=(new Date).getTime();i=b};g.update=function(){J.beginUpdate();I=b;Q();I=c;J.endUpdate()};g.idle=function(){}}})();var Y,G;(function(){var L="----seadragon----",Q=e.getBrowser();G=f.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4};function P(c,b,a){if(b==G.TOP_RIGHT||b==G.BOTTOM_RIGHT)a.insertBefore(c,a.firstChild);else a.appendChild(c)}function g(f,c,d){var b=this,a=e.makeNeutralElement(F);b.elmt=f;b.anchor=c;b.container=d;b.wrapper=a;a.style.display=C;a.appendChild(f);if(c==G.NONE)a.style.width=a.style.height=m;P(a,c,d)}g.prototype.destroy=function(){var a=this;a.wrapper.removeChild(a.elmt);a.container.removeChild(a.wrapper)};g.prototype.isVisible=function(){return this.wrapper.style.display!=B};g.prototype.setVisible=function(a){this.wrapper.style.display=a?C:B};g.prototype.setOpacity=function(a){if(this.elmt[L]&&Q==A.IE)e.setElementOpacity(this.elmt,a,b);else e.setElementOpacity(this.wrapper,a,b)};var l="fullpage",E="home",r="zoomin",o="zoomout",J="_rest.png",y="_grouphover.png",z="_hover.png",D="_pressed.png";function N(d){var g=a,f=c,p=a,k=a;function H(){d.viewport&&d.viewport.goHome()}function w(){d.setFullPage(!d.isFullPage());g.emulateExit();d.viewport&&d.viewport.applyConstraints()}function t(){k=(new Date).getTime();p=j.zoomPerSecond;f=b;n()}function s(){k=(new Date).getTime();p=1/j.zoomPerSecond;f=b;n()}function m(){f=c}function n(){i.setTimeout(F,q)}function F(){if(f&&d.viewport){var a=(new Date).getTime(),c=a-k,b=h.pow(p,c/1e3);d.viewport.zoomBy(b);d.viewport.applyConstraints();k=a;n()}}function v(){if(d.viewport){f=c;d.viewport.zoomBy(j.zoomPerClick/1);d.viewport.applyConstraints()}}function u(){if(d.viewport){f=c;d.viewport.zoomBy(1/j.zoomPerClick);d.viewport.applyConstraints()}}function B(){g.emulateEnter();g.emulateExit()}function e(b,a){return j.imagePath+b+a}var I=new O(x.getString("Tooltips.ZoomIn"),e(r,J),e(r,y),e(r,z),e(r,D),t,m,v,t,m),C=new O(x.getString("Tooltips.ZoomOut"),e(o,J),e(o,y),e(o,z),e(o,D),s,m,u,s,m),G=new O(x.getString("Tooltips.Home"),e(E,J),e(E,y),e(E,z),e(E,D),a,H,a,a,a),A=new O(x.getString("Tooltips.FullPage"),e(l,J),e(l,y),e(l,z),e(l,D),a,w,a,a,a);g=new R([I,C,G,A]);g.elmt[L]=b;d.addEventListener("open",B);return g.elmt}Y=f.Viewer=function(r){var l=this,o=l,P=e.getElement(r),r=e.makeNeutralElement(u),E=e.makeNeutralElement(u),eb=e.makeNeutralElement(u),fb=e.makeNeutralElement(u),db=e.makeNeutralElement(u),cb=e.makeNeutralElement(u),A=a,J=a,f=a,O=a,z=new W,D=new M(E),S=new M(r),y=[],ab=b,ib=a,L=a,kb=1e3,Ab=2e3,ib=a,ab=c,yb=t.body.style.width,wb=t.body.style.height,tb=t.body.style.overflow,ub=t.documentElement.style.overflow,bb=new n(1,1),C=a,R=0,nb=0,qb=a,ob=a,F=c,T=c,Y=c;l.container=P;l.elmt=r;l.source=a;l.drawer=a;l.viewport=a;l.profiler=a;l.tracker=D;function Jb(){var c=E.style,a=r.style,g=eb.style,h=fb.style,f=db.style,e=cb.style;a.width=m;a.height=m;a.position=v;a.left=k;a.top=k;a.textAlign="left";c.width=m;c.height=m;c.overflow=p;c.position=w;c.top=k;c.left=k;g.position=h.position=f.position=e.position=w;g.top=h.top=k;g.left=e.left=k;h.right=f.right=k;e.bottom=f.bottom=k;D.clickHandler=Fb;D.pressHandler=Gb;D.dragHandler=Hb;D.releaseHandler=Db;D.scrollHandler=Eb;D.setTracking(b);L=N(o);L.style.marginRight="4px";L.style.marginBottom="4px";o.addControl(L,G.BOTTOM_RIGHT);S.enterHandler=lb;S.exitHandler=pb;S.releaseHandler=Bb;S.setTracking(b);i.setTimeout(Q,1);r.appendChild(E);r.appendChild(eb);r.appendChild(fb);r.appendChild(db);r.appendChild(cb);P.innerHTML=d;P.appendChild(r)}function Z(f){var a="normal",c=t.createTextNode(f);E.innerHTML=d;E.appendChild(e.makeCenteredNode(c));var b=c.parentNode.style;b.fontFamily="verdana";b.fontSize="13px";b.fontSizeAdjust=B;b.fontStyle=a;b.fontStretch=a;b.fontVariant=a;b.fontWeight=a;b.lineHeight="1em";b.textAlign="center";b.textDecoration=B}function vb(){A&&zb();R=(new Date).getTime();i.setTimeout(function(){R>nb&&Z(x.getString("Messages.Loading"))},2e3);return R}function gb(h,a,g){nb=(new Date).getTime();if(h<R){s.log("Ignoring out-of-date open.");z.trigger("ignore",o);return}else if(!a){Z(g);z.trigger("error",o);return}E.innerHTML=d;C=e.getElementSize(r);if(C.x===0||C.y===0){i.setTimeout(function(){gb(h,a,g)},q);return}A=a;f=new X(C,A.dimensions);J=new V(A,f,E);O=new U;o.source=A;o.viewport=f;o.drawer=J;o.profiler=O;F=c;T=b;rb(Ib);z.trigger("open",o)}function zb(){o.source=A=a;o.viewport=f=a;o.drawer=J=a;o.profiler=O=a;E.innerHTML=d}function rb(c,a){if(F)return i.setTimeout(c,1);var b=(new Date).getTime(),a=a?a:b,d=a+1e3/60,e=h.max(1,d-b);return i.setTimeout(c,e)}function xb(){if(!A)return;O.beginUpdate();var a=e.getElementSize(r);if(!a.equals(C)&&a.x>0&&a.y>0){f.resize(a,b);C=a;z.trigger("resize",o)}var d=f.update();if(!F&&d){z.trigger("animationstart",o);hb()}if(d){J.update();z.trigger("animation",o)}else if(T||J.needsUpdate()){J.update();T=c}else J.idle();if(F&&!d){z.trigger("animationfinish",o);!Y&&Q()}F=d;O.endUpdate()}function Ib(){if(!A)return;var a=(new Date).getTime();xb();rb(arguments.callee,a)}function mb(b){for(var a=y.length-1;a>=0;a--)if(y[a].elmt==b)return a;return -1}function jb(){i.setTimeout(Cb,20)}function Cb(){if(ab){var c=(new Date).getTime(),d=c-ib,a=1-d/Ab;a=h.min(1,a);a=h.max(0,a);for(var b=y.length-1;b>=0;b--)y[b].setOpacity(a);a>0&&jb()}}function hb(){ab=c;for(var a=y.length-1;a>=0;a--)y[a].setOpacity(1)}function Q(){if(!j.autoHideControls)return;ab=b;ib=(new Date).getTime()+kb;i.setTimeout(jb,kb)}function lb(){Y=b;hb()}function pb(e,d,a){if(!a){Y=c;!F&&Q()}}function Bb(e,d,b,a){if(!a){Y=c;!F&&Q()}}function Fb(h,c,e,g){if(f&&e){var a=j.zoomPerClick,d=g?1/a:a;f.zoomBy(d,f.pointFromPixel(c,b));f.applyConstraints()}}function Gb(b,a){if(f){qb=a;ob=f.getCenter()}}function Hb(g,d,e){if(f)if(j.constrainDuringPan){var a=d.minus(qb),c=f.deltaPointsFromPixels(a.negate(),b);f.panTo(ob.plus(c));f.applyConstraints()}else f.panBy(f.deltaPointsFromPixels(e.negate(),b))}function Db(d,c,a){a&&f&&f.applyConstraints()}function Eb(e,a,d){if(f){var c=h.pow(j.zoomPerScroll,d);f.zoomBy(c,f.pointFromPixel(a,b));f.applyConstraints()}}function sb(a){a=e.getEvent(a);a.keyCode===27&&o.setFullPage(c)}l.isOpen=function(){return !!A};l.openDzi=function(b,f){var d=vb(),c=e.createCallback(a,gb,d);switch(typeof b){case I:K.createFromXml(b,f,c);break;default:K.createFromJson(b,c)}};l.openTileSource=function(b){var a=vb();i.setTimeout(function(){gb(a,b)},1)};l.close=function(){if(!A)return;zb()};l.addControl=function(b,d){var b=e.getElement(b);if(mb(b)>=0)return;var c=a;switch(d){case G.TOP_RIGHT:c=fb;b.style.position=v;break;case G.BOTTOM_RIGHT:c=db;b.style.position=v;break;case G.BOTTOM_LEFT:c=cb;b.style.position=v;break;case G.TOP_LEFT:c=eb;b.style.position=v;break;case G.NONE:default:c=r;b.style.position=w}y.push(new g(b,d,c))};l.removeControl=function(b){var b=e.getElement(b),a=mb(b);if(a>=0){y[a].destroy();y.splice(a,1)}};l.clearControls=function(){while(y.length>0)y.pop().destroy()};l.getNavControl=function(){return L};l.isDashboardEnabled=function(){for(var a=y.length-1;a>=0;a--)if(y[a].isVisible())return b;return c};l.isFullPage=function(){return r.parentNode==t.body};l.isMouseNavEnabled=function(){return D.isTracking()};l.isVisible=function(){return r.style.visibility!=p};l.setDashboardEnabled=function(b){for(var a=y.length-1;a>=0;a--)y[a].setVisible(b)};l.setFullPage=function(k){if(k==o.isFullPage())return;var s=t.body,c=s.style,j=t.documentElement.style,g=r.style,i=E.style;if(k){tb=c.overflow;ub=j.overflow;c.overflow=p;j.overflow=p;yb=c.width;wb=c.height;c.width=m;c.height=m;i.backgroundColor="black";i.color="white";g.position=H;g.zIndex="99999999";s.appendChild(r);C=e.getWindowSize();e.addEvent(t,"keydown",sb);lb()}else{c.overflow=tb;j.overflow=ub;c.width=yb;c.height=wb;i.backgroundColor=d;i.color=d;g.position=v;g.zIndex=d;P.appendChild(r);C=e.getElementSize(P);e.removeEvent(t,"keydown",sb);pb()}if(f){var q=f.getBounds();f.resize(C);var l=f.getBounds();if(k)bb=new n(l.width/q.width,l.height/q.height);else{f.update();f.zoomBy(h.max(bb.x,bb.y),a,b)}T=b;z.trigger("resize",o);xb()}};l.setMouseNavEnabled=function(a){D.setTracking(a)};l.setVisible=function(a){r.style.visibility=a?d:p};l.showMessage=function(a,b){if(!b){Z(a);return}i.setTimeout(function(){!o.isOpen()&&Z(a)},b)};l.addEventListener=function(a,b){z.addListener(a,b)};l.removeEventListener=function(a,b){z.removeListener(a,b)};Jb()}})();f.TouchController=function(g){var d=this,k=function(a){var b=this,a=a;b.init=function(){a.debugInit&&f.Debug.log("BaseState::init")};b.dispose=function(){a.debugDispose&&f.Debug.log("BaseState::dispose")};b.onTouchStart=function(d){a.debugTouchStart&&f.Debug.log("BaseState::onTouchStart");var b=d.touches.length,c=a.viewer.viewport;a.touchPixelOrigin=a.getTouchPixelOrigin(d);a.lastTouchPoint=c.getCenter();a.zoom=c.getZoom();if(b==1){a.setCurrentState(a.TAP_STATE);return}b==2&&a.setCurrentState(a.TWO_FINGER_TAP_STATE)};b.onTouchMove=function(){a.debugTouchMove&&f.Debug.error("BaseState::onTouchMove")};b.onTouchEnd=function(){a.debugTouchEnd&&f.Debug.error("BaseState::onTouchEnd")};b.onGestureStart=function(){a.debugGestureStart&&f.Debug.error("BaseState::onGestureStart")};b.onGestureChange=function(){a.debugGestureChange&&f.Debug.error("BaseState::onGestureChange")};b.onGestureEnd=function(){a.debugGestureEnd&&f.Debug.error("BaseState::onGestureEnd")};b.toString=function(){return "BaseState"}},m=function(b){var c=this,b=b,d=a;c.init=function(){b.debugInit&&f.Debug.log("TapState::init");d=setTimeout(this.timeoutHandler,b.TAP_TIMEOUT)};c.dispose=function(){b.debugDispose&&f.Debug.log("TapState::dispose");d&&clearTimeout(d)};c.timeoutHandler=function(){if(d){clearTimeout(d);d=a}b.setCurrentState(b.DRAG_STATE)};c.onTouchStart=function(c){b.debugTouchStart&&f.Debug.error("TapState::onTouchStart");var a=c.touches.length;if(a>=1){b.setCurrentState(b.PINCH_STATE);return}a>=2&&f.Debug.error("TapState::onTouchStart (numTouches == "+a+") >= 2")};c.onTouchMove=function(a){b.debugTouchMove&&f.Debug.log("TapState::onTouchMove");var e=a.touches.length,c=b.getTouchPixelOrigin(a),d=c.distanceTo(b.touchPixelOrigin);d>b.TAP_DISTANCE_TRESHOLD&&b.setCurrentState(b.DRAG_STATE)};c.onTouchEnd=function(e){b.debugTouchEnd&&f.Debug.log("TapState::onTouchEnd");var d=e.touches.length;d!=0&&f.Debug.error("TapState::onTouchEnd numTouches != 0");var a=g.viewport,c=a.pointFromPixel(b.touchPixelOrigin);a.zoomBy(b.TAP_ZOOM_FACTOR,c);a.ensureVisible();b.zoom=a.getZoom();b.setCurrentState(b.BASE_STATE)};c.onGestureStart=function(){b.debugGestureStart&&f.Debug.log("TapState::onGestureStart")};c.onGestureChange=function(){b.debugGestureChange&&f.Debug.log("TapState::onGestureChange")};c.onGestureEnd=function(){b.debugGestureEnd&&f.Debug.log("TapState::onGestureEnd")};c.toString=function(){return "TapState"}},i=function(b){var c=this,b=b,d=a;c.init=function(){b.debugInit&&f.Debug.log("TwoFingerTapState::init");d=setTimeout(this.timeoutHandler,b.TAP_TIMEOUT)};c.dispose=function(){b.debugDispose&&f.Debug.log("TwoFingerTapState::dispose");d&&clearTimeout(d)};c.timeoutHandler=function(){if(d){clearTimeout(d);d=a}b.setCurrentState(b.DRAG_STATE)};c.onTouchStart=function(){b.debugTouchStart&&f.Debug.error("TwoFingerTapState::onTouchStart");b.setCurrentState(b.PINCH_STATE)};c.onTouchMove=function(d){b.debugTouchMove&&f.Debug.log("TwoFingerTapState::onTouchMove");var a=b.getTouchPixelOrigin(d),c=a.distanceTo(b.touchPixelOrigin);c>b.TAP_DISTANCE_TRESHOLD&&b.setCurrentState(b.DRAG_STATE)};c.onTouchEnd=function(e){b.debugTouchEnd&&f.Debug.log("TwoFingerTapState::onTouchEnd");var d=e.touches.length;if(d==0){var a=g.viewport,c=a.pointFromPixel(b.touchPixelOrigin);a.zoomBy(b.DOUBLE_TAP_ZOOM_FACTOR,c);a.ensureVisible();b.zoom=a.getZoom();b.setCurrentState(b.BASE_STATE)}};c.onGestureStart=function(){b.debugGestureStart&&f.Debug.log("TwoFingerTapState::onGestureStart")};c.onGestureChange=function(){b.debugGestureChange&&f.Debug.log("TwoFingerTapState::onGestureChange")};c.onGestureEnd=function(){b.debugGestureEnd&&f.Debug.log("TwoFingerTapState::onGestureEnd")};c.toString=function(){return "TwoFingerTapState"}},l=function(a){var b=this,a=a;b.init=function(){a.debugInit&&f.Debug.log("DragState::init")};b.dispose=function(){a.debugDispose&&f.Debug.log("DragState::dispose")};b.onTouchStart=function(c){a.debugTouchStart&&f.Debug.log("DragState::onTouchStart");var b=c.touches.length;if(b>=1){a.setCurrentState(a.PINCH_STATE);return}b>=2&&f.Debug.error("TapState::onTouchEnd (numTouches =="+b+") >= 2")};b.onTouchMove=function(g){a.debugTouchMove&&f.Debug.log("DragState::onTouchMove");var h=g.touches.length;if(h>=2){a.setCurrentState(a.PINCH_STATE);return}var c=a.getTouchPixelOrigin(g),b=a.viewer.viewport,e=b.getContainerSize(),d=b.getBounds(),l=(c.x-a.touchPixelOrigin.x)/e.x,m=(c.y-a.touchPixelOrigin.y)/e.y,i=a.lastTouchPoint.x-l*d.width*1.2,j=a.lastTouchPoint.y-m*d.height*1.2,k=new f.Point(i,j);b.panTo(k);b.ensureVisible()};b.onTouchEnd=function(c){a.debugTouchEnd&&f.Debug.log("DragState::onTouchEnd");var b=c.touches.length;b==0&&a.setCurrentState(a.BASE_STATE)};b.onGestureStart=function(){a.debugGestureStart&&f.Debug.log("DragState::onGestureStart")};b.onGestureChange=function(){a.debugGestureChange&&f.Debug.log("DragState::onGestureChange")};b.onGestureEnd=function(){a.debugGestureEnd&&f.Debug.log("DragState::onGestureEnd")};b.toString=function(){return "DragState"}},j=function(a){var c=this,a=a;c.init=function(){a.debugInit&&f.Debug.log("PinchState::init")};c.dispose=function(){a.debugGestureEnd&&f.Debug.log("PinchState::dispose")};c.onTouchStart=function(){a.debugTouchStart&&f.Debug.log("PinchState::onTouchStart")};c.onTouchMove=function(b){a.debugTouchMove&&f.Debug.log("PinchState::onTouchMove");a.touchPixelOrigin=a.getTouchPixelOrigin(b)};c.onTouchEnd=function(c){a.debugTouchEnd&&f.Debug.log("PinchState::onTouchEnd");var b=c.touches.length;b==0&&a.setCurrentState(a.BASE_STATE)};c.onGestureStart=function(){a.debugGestureStart&&f.Debug.log("PinchState::onGestureStart")};c.onGestureChange=function(d){a.debugGestureChange&&f.Debug.log("PinchState::onGestureChange: event.scale"+d.scale);var c=a.viewer.viewport,e=c.pointFromPixel(a.touchPixelOrigin);c.zoomTo(a.zoom*d.scale,e,b);c.ensureVisible()};c.onGestureEnd=function(){a.debugGestureEnd&&f.Debug.log("PinchState::onGestureEnd")};c.toString=function(){return "PinchState"}};d.viewer=g;d.touchPixelOrigin=a;d.lastTouchPoint=a;d.lastZoom=1;d.debugInit=c;d.debugDispose=c;d.debugTouchStart=c;d.debugTouchMove=c;d.debugTouchEnd=c;d.debugGestureStart=c;d.debugGestureChange=c;d.debugGestureEnd=c;!g&&f.Debug.error("Seadragon.TouchController: viewer is null.");var e=a;d.getCurrentState=function(){return e};d.setCurrentState=function(a){!a&&f.Debug.error("Seadragon.TouchController::setCurrentState: argument is null.");e&&e.dispose();e=a;e.init()};d.getTouchPixelOrigin=function(d){for(var b=d.touches.length,a=new f.Point(0,0),c=0;c<b;c++){var e=d.touches[c];a.x+=e.pageX;a.y+=e.pageY}a.x/=b;a.y/=b;return a};d.onTouchStart=function(a){a.preventDefault();e.onTouchStart(a)};d.onTouchMove=function(a){a.preventDefault();e.onTouchMove(a)};d.onTouchEnd=function(a){a.preventDefault();e.onTouchEnd(a)};d.onGestureStart=function(a){a.preventDefault();e.onGestureStart(a)};d.onGestureChange=function(a){a.preventDefault();e.onGestureChange(a)};d.onGestureEnd=function(a){a.preventDefault();e.onGestureEnd(a)};d.TAP_ZOOM_FACTOR=2;d.DOUBLE_TAP_ZOOM_FACTOR=r;d.SCALE_TRESHOLD=.02;d.TAP_DISTANCE_TRESHOLD=5;d.TAP_TIMEOUT=800;d.BASE_STATE=new k(d);d.TAP_STATE=new m(d);d.TWO_FINGER_TAP_STATE=new i(d);d.PINCH_STATE=new j(d);d.DRAG_STATE=new l(d);d.setCurrentState(d.BASE_STATE);if(g&&g.drawer&&g.drawer.elmt){var h=g.drawer.elmt;f.Utils.addEvent(h,"touchstart",d.onTouchStart);f.Utils.addEvent(h,"touchmove",d.onTouchMove);f.Utils.addEvent(h,"touchend",d.onTouchEnd);f.Utils.addEvent(h,"gesturestart",d.onGestureStart);f.Utils.addEvent(h,"gesturechange",d.onGestureChange);f.Utils.addEvent(h,"gestureend",d.onGestureEnd)}else f.Debug.error("Could not set up TouchController.")}})(window,document,Math);